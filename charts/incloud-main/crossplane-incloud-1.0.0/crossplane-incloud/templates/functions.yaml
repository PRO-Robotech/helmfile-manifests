{{- range $functionName, $functionValues := .Values.functions }}
---
apiVersion: pkg.crossplane.io/v1
kind: Function
metadata:
  name: {{ $functionName | lower }}
  annotations:
    argocd.argoproj.io/sync-wave: "0"
spec:
  package: {{ $functionValues.package }}
  {{- with $functionValues.runtimeConfig }}
  runtimeConfigRef:
    apiVersion: pkg.crossplane.io/v1beta1
    kind: DeploymentRuntimeConfig
    name: {{ $functionName | lower }}-drc

---
apiVersion: pkg.crossplane.io/v1beta1
kind: DeploymentRuntimeConfig
metadata:
  name: {{ $functionName | lower }}-drc
  annotations:
    argocd.argoproj.io/sync-wave: "0"
spec:
  {{ .spec | toYaml | nindent 2 }}
  {{- end }}
{{- end }}
